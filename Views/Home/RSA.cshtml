@* RSA.cshtml *@
@{
    ViewData["Title"] = "RSA Ä°ÅŸlemleri";
}

<div class="container main-content">
    <!-- RSA Key Generation Form -->
    <form method="post" action="/Crypto/GenerateRSAKeys" class="card">
        <h2>ðŸ”‘ RSA Anahtar Ã‡ifti OluÅŸturma</h2>
        <button type="submit" class="btn btn-primary" style="background-color: crimson; border-color: crimson;">RSA AnahtarlarÄ± OluÅŸtur</button>
    </form>

    <!-- Display Generated RSA Keys (Always visible if in session) -->
    @if (Context.Session.GetString("RSAPublicKey") != null)
    {
        <div class="card" style="margin-top: 20px;">
            <h2>OluÅŸturulan RSA AnahtarlarÄ±</h2>
            <div style="color:lime;"><b>AÃ§Ä±k Anahtar (Public Key):</b></div>
            <div class="input-group">
                <textarea id="rsaPublicKey" rows="5" style="width:100%; background:#121212; color:lime; border:1px solid crimson; padding:10px; margin-top:5px;" readonly>@Context.Session.GetString("RSAPublicKey")</textarea>
                <button type="button" class="btn btn-secondary" onclick="copyToClipboard('rsaPublicKey')" style="margin-left: 10px; background-color: #555; border-color: #555;">Kopyala</button>
            </div>
        </div>
    }
    @if (Context.Session.GetString("RSAPrivateKey") != null)
    {
        <div class="card" style="margin-top: 20px;">
            <div style="color:lime;"><b>Ã–zel Anahtar (Private Key):</b></div>
            <div class="input-group">
                <textarea id="rsaPrivateKey" rows="10" style="width:100%; background:#121212; color:lime; border:1px solid crimson; padding:10px; margin-top:5px;" readonly>@Context.Session.GetString("RSAPrivateKey")</textarea>
                <button type="button" class="btn btn-secondary" onclick="copyToClipboard('rsaPrivateKey')" style="margin-left: 10px; background-color: #555; border-color: #555;">Kopyala</button>
            </div>
        </div>
    }

    <!-- RSA Text Encryption Form -->
    <form method="post" action="/Crypto/EncryptRSA" class="card">
        <h2>ðŸ”’ RSA Metin Åžifreleme</h2>
        <input type="text" name="data" placeholder="Åžifrelenecek Metin" required />
        <textarea name="publicKey" placeholder="RSA AÃ§Ä±k Anahtar (BoÅŸ bÄ±rakÄ±rsanÄ±z oturumdaki kullanÄ±lÄ±r)" rows="5"></textarea>
        <button type="submit" class="btn btn-primary" style="background-color: crimson; border-color: crimson;">Åžifrele</button>
        @if (TempData["RSAEncryptResult"] != null)
        {
            <div style="margin-top:10px; color:lime; word-break:break-all;">
                @if (TempData["RSAEncryptInput"] != null)
                {
                    <div style="color:#fff;"><b>Girdi:</b> @TempData["RSAEncryptInput"]</div>
                }
                @if (TempData["RSAEncryptKey"] != null)
                {
                    <div style="color:#fff;"><b>KullanÄ±lan AÃ§Ä±k Anahtar:</b> @TempData["RSAEncryptKey"].ToString().Substring(0, Math.Min(64, TempData["RSAEncryptKey"].ToString().Length)) ...</div>
                }
                <b>Åžifreli Metin:</b> @TempData["RSAEncryptResult"]
            </div>
        }
    </form>

    <!-- RSA Text Decryption Form -->
    <form method="post" action="/Crypto/DecryptRSA" class="card">
        <h2>ðŸ”“ RSA Metin DeÅŸifreleme</h2>
        <input type="text" name="encryptedData" placeholder="DeÅŸifrelenecek Metin" required />
        <textarea name="privateKey" placeholder="RSA Ã–zel Anahtar (BoÅŸ bÄ±rakÄ±rsanÄ±z oturumdaki kullanÄ±lÄ±r)" rows="10"></textarea>
        <button type="submit">DeÅŸifrele</button>
        @if (TempData["RSADecryptResult"] != null)
        {
            <div style="margin-top:10px; color:lime; word-break:break-all;">
                @if (TempData["RSADecryptInput"] != null)
                {
                    <div style="color:#fff;"><b>Girdi:</b> @TempData["RSADecryptInput"]</div>
                }
                @if (TempData["RSADecryptKey"] != null)
                {
                    <div style="color:#fff;"><b>KullanÄ±lan Ã–zel Anahtar:</b> @TempData["RSADecryptKey"].ToString().Substring(0, Math.Min(64, TempData["RSADecryptKey"].ToString().Length)) ...</div>
                }
                <b>DeÅŸifrelenmiÅŸ Metin:</b> @TempData["RSADecryptResult"]
            </div>
        }
    </form>

    <!-- RSA File Encryption Form -->
    <form method="post" enctype="multipart/form-data" action="/Crypto/EncryptRSAFile" class="card">
        <h2>ðŸ“„ RSA Dosya Åžifreleme (Hibrid)</h2>
        <input type="file" name="file" required />
        <textarea name="publicKey" placeholder="RSA AÃ§Ä±k Anahtar (BoÅŸ bÄ±rakÄ±rsanÄ±z oturumdaki kullanÄ±lÄ±r)" rows="5"></textarea>
        <button type="submit">DosyayÄ± Åžifrele</button>
        @if (TempData["RSAEncryptFileResult"] != null)
        {
            <div style="margin-top:10px; color:lime; word-break:break-all;">
                <b>SonuÃ§:</b> @TempData["RSAEncryptFileResult"]
                @if (TempData["RSAEncryptedAesKey"] != null && TempData["RSAEncryptedAesIV"] != null)
                {
                    <div style="color:#fff; margin-top:10px;"><b>ÅžifrelenmiÅŸ AES AnahtarÄ±nÄ± Kaydedin:</b></div>
                    <textarea rows="3" style="width:100%; background:#121212; color:lime; border:1px solid crimson; padding:10px; margin-top:5px;" readonly>@TempData["RSAEncryptedAesKey"]</textarea>
                    <div style="color:#fff; margin-top:10px;"><b>ÅžifrelenmiÅŸ AES IV'sini Kaydedin:</b></div>
                    <textarea rows="3" style="width:100%; background:#121212; color:lime; border:1px solid crimson; padding:10px; margin-top:5px;" readonly>@TempData["RSAEncryptedAesIV"]</textarea>
                }
                @if (TempData["RSAEncryptedTempFileName"] != null)
                {
                    <div style="color:#fff; margin-top:10px;"><b>Åžifreli DosyayÄ± Ä°ndirin:</b></div>
                    <a href="/Crypto/DownloadRSAEncryptedFile?fileName=@TempData["RSAEncryptedTempFileName"]" download="@TempData["RSAOriginalFileName"].ToString().Replace(".enc", "") + ".enc" class="btn btn-primary" style="margin-top:10px; background-color: crimson; border-color: crimson;">Åžifreli DosyayÄ± Ä°ndir</a>
                }
            </div>
        }
    </form>

    <!-- RSA File Decryption Form -->
    <form method="post" enctype="multipart/form-data" action="/Crypto/DecryptRSAFile" class="card">
        <h2>ðŸ“‚ RSA Dosya DeÅŸifreleme (Hibrid)</h2>
        <input type="file" name="file" required />
        <textarea name="privateKey" placeholder="RSA Ã–zel Anahtar (BoÅŸ bÄ±rakÄ±rsanÄ±z oturumdaki kullanÄ±lÄ±r)" rows="10"></textarea>
        <textarea name="encryptedAesKeyBase64" placeholder="ÅžifrelenmiÅŸ AES AnahtarÄ± (Base64)" rows="3" required></textarea>
        <textarea name="encryptedAesIVBase64" placeholder="ÅžifrelenmiÅŸ AES IV (Base64)" rows="3" required></textarea>
        <button type="submit" class="btn btn-primary" style="background-color: crimson; border-color: crimson;">DosyayÄ± DeÅŸifrele</button>
        @if (TempData["RSADecryptFileResult"] != null)
        {
            <div style="margin-top:10px; color:lime; word-break:break-all;">
                <b>SonuÃ§:</b> @TempData["RSADecryptFileResult"]
                @if (TempData["RSADecryptedTempFileName"] != null && TempData["RSADecryptedOriginalFileName"] != null)
                {
                    <div style="color:#fff; margin-top:10px;"><b>DeÅŸifreli DosyayÄ± Ä°ndirin:</b></div>
                    <a href="/Crypto/DownloadRSADecryptedFile?fileName=@TempData["RSADecryptedTempFileName"]&originalFileName=@TempData["RSADecryptedOriginalFileName"]" download="@TempData["RSADecryptedOriginalFileName"]" class="btn btn-primary" style="margin-top:10px; background-color: crimson; border-color: crimson;">DeÅŸifreli DosyayÄ± Ä°ndir</a>
                }
            </div>
        }
    </form>
</div>

@section Scripts {
    <script>
        function copyToClipboard(elementId) {
            var element = document.getElementById(elementId);
            element.select();
            document.execCommand('copy');
            alert('KopyalandÄ±!');
        }
    </script>
} 